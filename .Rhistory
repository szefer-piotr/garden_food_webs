subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
hist(log(subpdf), breaks = 25)
hist(log(subcdf), breaks = 25)
plot(density(subpdf, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(density(subcdf, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="gray80", main = paste(family))
}
family
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
plot(density(subpdf, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(density(subcdf, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="gray80", main = paste(family))
subc
plot(density(subpdf, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
plot(density(subpdf, na.rm = T, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
plot(density(subcdf, na.rm = T, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="gray80", main = paste(family))
plot(density(subpdf, na.rm = T, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(density(subcdf, na.rm = T, adjust = 6, kernel = "gaussian"),
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="gray80", main = paste(family))
dp <- density(subpdf, na.rm = T, adjust = 6, kernel = "gaussian")
dp
names(dp)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dp
plot(dp,
lty=2,xlim = c(0,  0.6), ylim = c(0,5),
lwd=2, col="red", main="",
xlab = "", ylab = "")
plot(dp)
dc <- density(subcdf, na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
plot(dp)
plot(dc)
max(dp$y)
max(dc$y)
pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$y),min(dc$y)), pmax(max(dp$y),max(dc$y)))
xl
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
xl
plot(dp,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dp,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
family = "aran"
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
plot(dp)
plot(dc)
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dp,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
plot(dp)
plot(dc)
plot(dp)
plot(dc)
yl <- pmax(max(dp$y),max(dc$y))
plot(dp)
plot(dc)
plot(dp)
plot(dc)
family = "mant"
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
plot(dp)
plot(dc)
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dp,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
par(new=TRUE)
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
par(new=TRUE)
plot(dp,
lty=1,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
for(family in unique(ins_bio$family)){
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
plot(dp)
plot(dc)
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
par(new=TRUE)
plot(dp,
lty=1,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
}
for(family in unique(ins_bio$family)){
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
par(new=TRUE)
plot(dp,
lty=1,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
}
ks.test(log(subcdf), log(subpdf))
for(family in unique(ins_bio$family)){
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
par(new=TRUE)
plot(dp,
lty=1,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
print(family)
ks.test(log(subcdf), log(subpdf))
}
for(family in unique(ins_bio$family)){
sub <- ibcp[ibcp$family == family, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
yl <- pmax(max(dp$y),max(dc$y))
xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
plot(dc,
lty=2,xlim = xl, ylim = c(0,yl),
lwd=2, col="gray80", main = paste(family))
par(new=TRUE)
plot(dp,
lty=1,xlim = xl, ylim = c(0,yl),
lwd=2, col="red", main="",
xlab = "", ylab = "")
print(family)
print(ks.test(log(subcdf), log(subpdf)))
}
qqplot(subpdf, subcdf)
qqplot(log(subpdf), log(subcdf))
qqplot(log(subpdf))
qqplot(log(subpdf))
qqplot(log(subpdf)), log(subcdf))
qqplot(log(subpdf), log(subcdf))
abline(a = 0, b = 1, lty = 3)
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
each = c(length(subpdf),
length(subcdf))))
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))))
dat
wilcox.test(lbio ~ type, data = dat)
t.test(lbio ~ type, data = dat)
ins_bio
names(ins_bio)
ins_bio$block <- substr(ins_bio$plot, 3, 4)
ins_bio
for(bl in ins_bio$block){
print(bl)
}
for(bl in unique(ins_bio$block)){
print(bl)
}
ssdf <- data.frame()
family = "mant"
bl = "g1"
print(bl)
sub <- ibcp[ibcp$family == family & ibcp&block == bl, ]
ibcp&block
# Size structure change
source("code/data_processing_code.R")
psites <- as.character(treats[treats$treat %in% c("PREDATOR"), ]$codes)
csites <- as.character(treats[treats$treat %in% c("CONTROL"), ]$codes)
ins_bio$block <- substr(ins_bio$plot, 3, 4)
ibcp <- ins_bio[ins_bio$plot %in% c(psites,csites), ]
ibcp$mode <- "herbivore"
ibcp[grep("aran|mant", ibcp$morphotype),]$mode <- "predator"
family = "mant"
bl = "g1"
print(bl)
sub <- ibcp[ibcp$family == family & ibcp&block == bl, ]
ibcp
sub <- ibcp[ibcp$family == family & ibcp$block == bl, ]
sub
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subp
subc
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
print(family)
print(ks.test(log(subcdf), log(subpdf)))
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl)
dat
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl,
fam = family)
ssdf <- rbind(ssdf, dat)
ssdf <- data.frame()
ssdf <- rbind(ssdf, dat)
ssdf
ssdf <- rbind(ssdf, dat)
for(bl in unique(ins_bio$block)){
print(bl)
sub <- ibcp[ibcp$family == family & ibcp$block == bl, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
# dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
# dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
#
# yl <- pmax(max(dp$y),max(dc$y))
# xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
#
# plot(dc,
#      lty=2,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="gray80", main = paste(family))
# par(new=TRUE)
# plot(dp,
#      lty=1,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="red", main="",
#      xlab = "", ylab = "")
print(family)
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl,
fam = family)
ssdf <- rbind(ssdf, dat)
}
for(family in unique(ins_bio$family)){
for(bl in unique(ins_bio$block)){
print(bl)
sub <- ibcp[ibcp$family == family & ibcp$block == bl, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
# dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
# dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
#
# yl <- pmax(max(dp$y),max(dc$y))
# xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
#
# plot(dc,
#      lty=2,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="gray80", main = paste(family))
# par(new=TRUE)
# plot(dp,
#      lty=1,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="red", main="",
#      xlab = "", ylab = "")
print(family)
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl,
fam = family)
ssdf <- rbind(ssdf, dat)
}
}
ssdf <- data.frame()
ssdf <- data.frame()
for(family in unique(ins_bio$family)){
for(bl in unique(ins_bio$block)){
print(bl)
sub <- ibcp[ibcp$family == family & ibcp$block == bl, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
# dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
# dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
#
# yl <- pmax(max(dp$y),max(dc$y))
# xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
#
# plot(dc,
#      lty=2,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="gray80", main = paste(family))
# par(new=TRUE)
# plot(dp,
#      lty=1,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="red", main="",
#      xlab = "", ylab = "")
print(family)
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl,
fam = family)
ssdf <- rbind(ssdf, dat)
}
}
ssdf
library(lmer)
library(lmerTest)
lmer(lbio~type+(1|fam/block), data=ssdf)
summary(lmer(lbio~type+(1|fam/block), data=ssdf))
summary(lmer(lbio~type+(1|block), data=ssdf))
summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
summary(lmer(lbio~type+(1|block), data=ssdf))
# We have change in the size structure towards larger herbivores!
slmer <- summary(lmer(lbio~type+(1|block), data=ssdf))
# We have change in the size structure towards larger herbivores!
slmer <- summary(lmer(lbio~type+(1|block), data=ssdf))
# We have change in the size structure towards larger herbivores!
mod1 <- summary(lmer(lbio~type+(1|block), data=ssdf))
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
mod1$coefficients
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
mod1$coefficients[1,1]
mod1$coefficients[2,1]
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
log(mod1$coefficients[1,1])
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
log(mod1$coefficients[1,1])
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
exp(mod1$coefficients[1,1])
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
IC <- mod1$coefficients[1,1]
exp(IC)
C <- mod1$coefficients[2,1]
exp(IC) # average size of a herbivore
exp(IC+ C)# <- average size in predator exclosure
# Size structure change
source("code/data_processing_code.R")
psites <- as.character(treats[treats$treat %in% c("PREDATOR"), ]$codes)
csites <- as.character(treats[treats$treat %in% c("CONTROL"), ]$codes)
ins_bio$block <- substr(ins_bio$plot, 3, 4)
ibcp <- ins_bio[ins_bio$plot %in% c(psites,csites), ]
ibcp$mode <- "herbivore"
ibcp[grep("aran|mant", ibcp$morphotype),]$mode <- "predator"
ssdf <- data.frame()
for(family in unique(ins_bio$family)){
for(bl in unique(ins_bio$block)){
print(bl)
sub <- ibcp[ibcp$family == family & ibcp$block == bl, ]
subp <- sub[sub$plot %in% psites, ]
subc <- sub[sub$plot %in% csites, ]
subpdf <- rep(subp$bio, subp$amount)
subcdf <- rep(subc$bio, subc$amount)
# hist(log(subpdf), breaks = 25)
# hist(log(subcdf), breaks = 25)
# dp <- density(log(subpdf), na.rm = T, adjust = 6, kernel = "gaussian")
# dc <- density(log(subcdf), na.rm = T, adjust = 6, kernel = "gaussian")
#
# yl <- pmax(max(dp$y),max(dc$y))
# xl <- c(pmin(min(dp$x),min(dc$x)), pmax(max(dp$x),max(dc$x)))
#
# plot(dc,
#      lty=2,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="gray80", main = paste(family))
# par(new=TRUE)
# plot(dp,
#      lty=1,xlim = xl, ylim = c(0,yl),
#      lwd=2, col="red", main="",
#      xlab = "", ylab = "")
print(family)
dat <- data.frame(lbio = c(log(subpdf),log(subcdf)),
type = rep(c("predator", "control"),
c(length(subpdf),
length(subcdf))),
block = bl,
fam = family)
ssdf <- rbind(ssdf, dat)
}
}
library(lmer)
library(lmerTest)
# We have change in the size structure towards larger herbivores!
mod1 <- summary(lmer(lbio~type+(1|block), data=ssdf))
# summary(lmer(lbio~type+(1|block/fam), data=ssdf)) # family nested within the block
IC <- mod1$coefficients[1,1]
C <- mod1$coefficients[2,1]
exp(IC) # average size of a herbivore
exp(IC+ C)# <- average size in predator exclosure
# We have change in the size structure towards larger herbivores!
mod1 <- summary(lmer(lbio~type+fam  + (1|block), data=ssdf))
summary(mod1)
plot(lbio~type, ssdf)
plot(lbio~type, ssdf[ssdf$fam == family, ])
family = "homo"
plot(lbio~type, ssdf[ssdf$fam == family, ])
family = "lepi"
plot(lbio~type, ssdf[ssdf$fam == family, ])
plot(lbio~type, ssdf[ssdf$fam == family, ],pch=19, col=block)
ggplot2::ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type)+
library(ggplot2)
ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type)+
ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type))+
geom_jitter()
ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type, colour = block))+
geom_jitter()
ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type, colour = block))+
geom_jitter(width=0.1)
family = "aran"
library(ggplot2)
ggplot(ssdf[ssdf$fam == family, ], aes(y=lbio, x = type, colour = block))+
geom_jitter(width=0.1)
